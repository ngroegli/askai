# AskAI CLI - High-Level System Architecture
title: "AskAI CLI - System Overview"

user: "User" {
  shape: person
  style.fill: "#90CAF9" # Light Blue
}

web_client: "Web Client" {
  shape: rectangle
  style.fill: "#FFB74D" # Light Orange
}

# Presentation Layer
presentation: "Presentation Layer" {
  shape: rectangle
  style.fill: "#F3E5F5" # Light Purple

  cli_parser: "CLI Parser" { style.fill: "#CE93D8" }
  command_handler: "Command Handler" { style.fill: "#CE93D8" }
  banner_parser: "Banner Display" { style.fill: "#CE93D8" }

  api_routes: "REST API Routes" { style.fill: "#BA68C8" }
  flask_app: "Flask Application" { style.fill: "#BA68C8" }
  swagger_docs: "Swagger Documentation" { style.fill: "#BA68C8" }

  tui_components: "TUI Components" { style.fill: "#AB47BC" }
}

# Application Core
app: "Application Core" {
  shape: rectangle
  style.fill: "#E3F2FD" # Light Blue

  orchestrator: "Main Orchestrator (main.py)" { style.fill: "#90CAF9" }
  workflow: "Workflow Coordinator" { style.fill: "#90CAF9" }
}

# Core Business Logic Layer
core: "Core Business Logic" {
  shape: rectangle
  style.fill: "#E8F5E9" # Light Green

  ai_module: "AI Services" { style.fill: "#A5D6A7" }
  patterns_module: "Pattern System" { style.fill: "#A5D6A7" }
  questions_module: "Question Processing" { style.fill: "#A5D6A7" }
  chat_module: "Chat Management" { style.fill: "#A5D6A7" }
  messaging_module: "Message Building" { style.fill: "#A5D6A7" }
}

# Output Processing Layer
output: "Output Processing" {
  shape: rectangle
  style.fill: "#FFF9C4" # Light Yellow

  output_coordinator: "Output Coordinator" { style.fill: "#FFF176" }
  file_operations: "File Writers" { style.fill: "#FFF176" }
  formatters: "Display Formatters" { style.fill: "#FFF176" }
  processors: "Content Processors" { style.fill: "#FFF176" }
}

# Utils Layer
utils: "Utilities Layer" {
  shape: rectangle
  style.fill: "#FAFAFA" # Light Gray

  config: "Configuration" { style.fill: "#BDBDBD" }
  logging: "Logging" { style.fill: "#BDBDBD" }
  helpers: "Helpers" { style.fill: "#BDBDBD" }
}

# External Services
external: "External Services" {
  shape: rectangle
  style.fill: "#FFF3E0" # Light Orange

  openrouter: "OpenRouter API" { style.fill: "#FFCC80" }
  ai_models: "AI Models" { style.fill: "#FFCC80" }
}

# Layer Connections
user -> presentation: "CLI Commands & Input"
web_client -> presentation: "HTTP Requests"
presentation -> app: "Parsed Arguments"
app -> core: "Business Logic Calls"
core -> output: "Output Processing"
core -> external: "API Requests"
external -> core: "AI Responses"
output -> presentation: "Formatted Output"
presentation -> user: "CLI Results & Feedback"
presentation -> web_client: "HTTP Responses"

# Utils services connections (all layers use utils)
presentation -> utils: "Common Services"
app -> utils: "Common Services"
core -> utils: "Common Services"
output -> utils: "Common Services"
